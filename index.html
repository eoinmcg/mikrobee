<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<style type="text/css">
body{margin:0;padding:0;background:#000;font-family:monospace;overflow:hidden;} 
canvas#game{position:absolute;left:50%;top:50%;display:none;background:transparent;image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: pixelated; image-rendering: crisp-edges;
  user-select:none;
  -webkit-user-select:none;
} 
h1{left:0;line-height:200px;margin:auto;margin-top:-100px;position:absolute;top:50%; width:100%;text-align: center;} 
#l{color:#fff;font-size: 150%;}
.fader {
  animation: fadeOut 2s ease-in-out;
}
@keyframes fader {
  0% { opacity: 1; }
  50% { opacity: 0; }
  100% { opacity: 0;}
}
</style></head><body>
<div id="l"><h1 id="h">Loading</h1></div><canvas id="game"></canvas>


<script>BUILD=true;(()=>{var i=class{constructor(t,i){this.images=t,this.loaded=[],this.loadedImgs=0,this.totalImgs=Object.keys(t).length,this.base=window.BUILD?"a/":"http://local/arcade/LOWREZ2024/a/",this.base="/",this.audio=i,this.totalAudio=i.length,window.AUDIO=[]}start(){return new Promise((t,i)=>{this.resolve=t,this.reject=i,this.loadImages(this.images),this.loadAudio()})}loadImages(i){Object.keys(i).forEach(t=>{this.loaded[t]=new Image,this.loaded[t].onload=t=>{this.loadedImage()},this.loaded[t].src="data:image/gif;base64,"+i[t]})}loadAudio(){this.audioLoaded=0,this.audio.forEach(t=>{var i=new Audio;i.addEventListener("canplaythrough",t=>{this.loadedAudio()},!1),i.src=this.base+t,window.AUDIO.push(i)})}loadedAudio(){this.totalAudio+=1,this.checkLoaded()}loadedImage(){this.loadedImgs+=1,this.checkLoaded()}checkLoaded(){this.loadedImgs===this.totalImgs&&this.audio.length===this.totalAudio&&setTimeout(()=>this.resolve(this.loaded),25)}},s=class{constructor(t,i){return this.w=t,this.h=i,this.c=document.getElementsByTagName("canvas")[0],this.ctx=this.c.getContext("2d",{alpha:!1}),this.c.width=t,this.c.height=i,this.c.style.width=t+"px",this.c.style.height=i+"px",window.addEventListener("resize",()=>{this.resize()}),window.addEventListener("fullscreenchange",()=>{this.resize()}),this.resize(),{c:this.c,ctx:this.ctx}}resize(){var t=this.w/this.h,i=this.c.style;let s=window.innerWidth,h=window.innerHeight;t<s/h?(s=h*t,i.height=h+"px",i.width=s+"px"):(h=s/t,i.width=s+"px",i.height=h+"px"),i.marginTop=-h/2+"px",i.marginLeft=-s/2+"px",i.transformOrigin="0 0",i.transform="scale(1)"}},A={timeStamp(){return window.performance.now()},pad(t,i=5){return Array(i-String(t).length+1).join("0")+t},rnd(t,i){return Math.floor(Math.random()*(i-t+1)+t)},rndArray(t){return t[~~(Math.random()*t.length)]},getHi(){try{return parseInt(localStorage.getItem("hi"),10)||250}catch(t){}return 250},setHi(t){try{localStorage.setItem("hi",t)}catch(t){return null}return!0},mkCanvas(t,i){var s=document.createElement("canvas"),h=s.getContext("2d");return s.width=t,s.height=i,h.mozImageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,s},toggleFullScreen(t){document.fullscreenElement?document.exitFullscreen():t.requestFullscreen()},mkFont:function(t,i,s){t=t.draw.color(t.imgs.font,t.data.pal[s],!0);return t.scale=i,t}},h=class{constructor(t,i,s){this.pal=s,this.c=t,this.ctx=i}clear(t){t=this.pal[t];this.ctx.fillStyle=`rgb(${t[0]},${t[1]},${t[2]})`,this.ctx.fillRect(0,0,this.c.width,this.c.height)}rect(t,i,s,h,e){e=this.pal[e];this.ctx.fillStyle=`rgb(${e[0]},${e[1]},${e[2]})`,this.ctx.fillRect(~~t,~~i,s,h)}img(t,i,s,h=!1,e=!1){e&&(this.ctx.globalAlpha=e),h&&(t=this.resize(t,h)),this.ctx.drawImage(t,~~i,~~s),e&&(this.ctx.globalAlpha=1)}rotate(t,i){var s=document.createElement("canvas"),h=s.getContext("2d"),e=Math.max(t.width,t.height);return s.width=e,s.height=e,h.translate(e/2,e/2),h.rotate(i+Math.PI/2),h.drawImage(t,-t.width/2,-t.height/2),s}flip(t,i,s){var h=A.mkCanvas(t.width,t.height),e=h.getContext("2d"),a=i?-1:1,r=s?-1:1,i=i?-1*t.width:0,s=s?-1*t.height:0;return h.width=t.width,h.height=t.height,e.save(),e.scale(a,r),e.drawImage(t,i,s,t.width,t.height),e.restore(),h}resize(t,i,s=1){var h=A.mkCanvas(t.width*i,t.height*i),e=h.getContext("2d");return h.width&&(e.save(),e.scale(i,i),s<1&&(this.ctx.globalAlpha=s),e.drawImage(t,0,0),s<1&&(this.ctx.globalAlpha=1),e.restore()),h.scale=i,h}color(t,i){var s=A.mkCanvas(t.width,t.height),h=s.getContext("2d");let e=0,a;for(h.drawImage(t,0,0),a=h.getImageData(0,0,t.width,t.height),e=0;e<a.data.length;e+=4)a.data[e+0]=i[0],a.data[e+1]=i[1],a.data[e+2]=i[2];return h.putImageData(a,0,0),s}textWidth(t,i){return t.length*(3*i.scale)+t.length*+i.scale}text(t,i,s,h){let e=0,a=this.ctx,r=0,A=3*i.scale,l=5*i.scale,o=+i.scale,n=this.textWidth(t,i),c=0;var d="0123456789".split("");for("number"!=typeof t&&"0"!==t[0]||(t+="",r=43),s=s||(this.c.width-n)/2,e=0;e<t.length;e+=1)r="number"==typeof t[e]||"0"===t[e]||-1!==d.indexOf(t[e])?43:0,c=(t.charCodeAt(e)-65+r)*(A+o),"?"===t[e]&&(c=144),":"===t[e]&&(c=148),-1<(c="%"===t[e]?152:c)&&a.drawImage(i,c,0,A,l,~~s,~~h,A,l),s+=A+o}},e=class{constructor(t,i){var s=window.addEventListener;let h=this;this.c=t,this.g=i,this.keys=[],this.freshKeys=[],this.m={x:i.w/2,y:i.h/2,click:0,touches:[],w:1,h:1},s("keydown",t=>{this.keys[t.code]=this.keys[t.code]?this.keys[t.code]+=1:1}),s("keyup",t=>{this.keys[t.code]=0,this.freshKeys[t.code]=1}),s("mousemove",t=>{this.trackMove(t)}),s("mousedown",()=>{this.m.click=1}),s("mouseup",()=>{this.m.click=0}),s("touchstart",function(t){h.touching=1,t.preventDefault(),h.trackTouch(t.touches)}),s("touchmove",function(t){t.preventDefault(),h.trackTouch(t.touches)}),s("touchend",function(t){t.preventDefault(),h.trackTouch(t.touches),h.touching=0})}trackMove(t){var i=this.g,s=i.canvas.c,h=s.offsetTop,e=s.offsetLeft,s=parseInt(s.style.width,10)/s.width,e=~~((t.pageX-e)/s),t=~~((t.pageY-h)/s),e=e>i.w?i.w:e,t=(t=t>i.h?i.h:t)<0?0:t;this.m.x=~~(e<0?0:e),this.m.y=~~t}trackTouch(t){let i=this.g,s=i.canvas.c,h=s.offsetTop,e=s.offsetLeft,a=parseInt(s.style.width,10)/s.width,r,A,l;for(this.m.touches=[],l=0;l<t.length&&!(2<l);l+=1)r=~~((t[l].pageX-e)/a),A=~~((t[l].pageY-h)/a),this.m.touches.push({x:r,y:A,w:1,h:1})}};function t(){this.set=function(t){for(var i=0;i<24;i++)this[String.fromCharCode(97+i)]=t[i]||0;this.c<.01&&(this.c=.01);var s=this.b+this.c+this.e;s<.18&&(this.b*=s=.18/s,this.c*=s,this.e*=s)}}function n(){var s=0,h=document.createElement("div");function t(t){return h.appendChild(t.dom),t}function i(t){for(var i=0;i<h.children.length;i++)h.children[i].style.display=i===t?"block":"none";s=t}h.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",document.body.appendChild(h),h.addEventListener("click",function(t){t.preventDefault(),i(++s%h.children.length)},!1);var e,a=(performance||Date).now(),r=a,A=0,l=t(new n.Panel("FPS","#0ff","#002")),o=t(new n.Panel("MS","#0f0","#020"));return self.performance&&self.performance.memory&&(e=t(new n.Panel("MB","#f08","#201"))),i(0),{REVISION:16,dom:h,addPanel:t,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){A++;var t,i=(performance||Date).now();return o.update(i-a,200),r+1e3<=i&&(l.update(1e3*A/(i-r),100),r=i,A=0,e)&&(t=performance.memory,e.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)),i},update:function(){a=this.end()},domElement:h,setMode:i}}var l=new function(){var J,W,X,V,U,Z,_,$,tt,it,st,ht,et=this;this._params=new t,et.r=function(){var t=et._params;V=100/(t.f*t.f+.001),U=100/(t.g*t.g+.001),Z=1-t.h*t.h*t.h*.01,_=-t.i*t.i*t.i*1e-6,t.a||(st=.5-t.n/2,ht=5e-5*-t.o),$=1+t.l*t.l*(0<t.l?-.9:10),tt=0,it=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},et.tr=function(){et.r();var t=et._params;return J=t.b*t.b*1e5,W=t.c*t.c*1e5,X=t.e*t.e*1e5+12,3*((J+W+X)/3|0)},et.s=function(t,i){for(var s,h,e,a,r,A=et._params,l=1!=A.s||A.v,o=A.v*A.v*.1,n=1+3e-4*A.w,c=A.s*A.s*A.s*.1,d=1+1e-4*A.t,g=1!=A.s,T=A.x*A.x,R=A.g,m=A.q||A.r,P=A.r*A.r*A.r*.2,F=A.q*A.q*(A.q<0?-1020:1020),p=A.p?32+((1-A.p)*(1-A.p)*2e4|0):0,z=A.d,u=A.j/2,q=A.k*A.k*.01,y=A.a,x=J,Y=1/J,Q=1/W,j=1/X,v=1-(v=.8<(v=5/(1+A.u*A.u*20)*(.01+c))?.8:v),w=!1,f=0,b=0,B=0,I=0,k=0,E=0,C=0,D=0,O=0,K=0,H=new Array(1024),M=new Array(32),G=H.length;G--;)H[G]=0;for(G=M.length;G--;)M[G]=2*Math.random()-1;for(G=0;G<i;G++){if(w)return G;if(p&&++O>=p&&(O=0,et.r()),it&&++tt>=it&&(it=0,V*=$),U<(V*=Z+=_)&&(V=U,0<R)&&(w=!0),h=V,0<u&&(K+=q,h*=1+Math.sin(K)*u),(h|=0)<8&&(h=8),y||((st+=ht)<0?st=0:.5<st&&(st=.5)),++b>x)switch(b=0,++f){case 1:x=W;break;case 2:x=X}switch(f){case 0:B=b*Y;break;case 1:B=1+2*(1-b*Q)*z;break;case 2:B=1-b*j;break;case 3:w=!(B=0)}m&&((e=0|(F+=P))<0?e=-e:1023<e&&(e=1023)),l&&n&&((o*=n)<1e-5?o=1e-5:.1<o&&(o=.1));for(var S=0,N=8;N--;){if(h<=++C&&(C%=h,3==y))for(var L=M.length;L--;)M[L]=2*Math.random()-1;switch(y){case 0:r=C/h<st?.5:-.5;break;case 1:r=1-C/h*2;break;case 2:r=.225*(((r=1.27323954*(a=6.28318531*(.5<(a=C/h)?a-1:a))+.405284735*a*a*(a<0?1:-1))<0?-1:1)*r*r-r)+r;break;case 3:r=M[Math.abs(32*C/h|0)]}l&&(s=E,(c*=d)<0?c=0:.1<c&&(c=.1),g?k=(k+(r-E)*c)*v:(E=r,k=0),r=I=(I+((E+=k)-s))*(1-o)),m&&(H[D%1024]=r,r+=H[(D-e+1024)%1024],D++),S+=r}S*=.125*B*T,t[G]=1<=S?32767:S<=-1?-32768:32767*S|0}return i}},a=function(t){l._params.set(t);var t=l.tr(),i=new Uint8Array(4*((t+1)/2|0)+44),s=2*l.s(new Uint16Array(i.buffer,44),t),t=new Uint32Array(i.buffer,0,44);t[0]=1179011410,t[1]=36+s,t[2]=1163280727,t[3]=544501094,t[4]=16,t[5]=65537,t[6]=44100,t[7]=88200,t[8]=1048578,t[9]=1635017060,t[10]=s,s+=44;for(var h=0,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="data:audio/wav;base64,";h<s;h+=3){var r=i[h]<<16|i[h+1]<<8|i[h+2];a+=e[r>>18]+e[r>>12&63]+e[r>>6&63]+e[63&r]}return a},r={init(t,i){var s=window,s=s.AudioContext||s.webkitAudioContextx;this.ctx=!!s&&new s,this.g=t,this.ctx&&this.encode(i)},encode(s){let h=this;h.sounds=[];const e=t=>{let i,s,h;for(t=a(t),i=(t=atob(t.substr(t.indexOf(",")+1))).length,s=new Uint8Array(i),h=0;h<i;h++)s[h]=t.charCodeAt(h);return s.buffer};Object.keys(s).forEach(t=>{var i;i=t,h.ctx.decodeAudioData(e(s[i]),t=>{h.sounds[i]=t})})},play(t){var i;this.g.mute||this.ctx&&this.sounds[t]&&((i=this.ctx.createBufferSource()).buffer=this.sounds[t],i.connect(this.ctx.destination),i.start(0))}},o=class{constructor(t,i,s=!1){this.c=t,this.rnd=i,this.skip=s,this.ttl=0,this.mag=0}start(t,i){this.mag=t,this.ttl=i,this.l=(window.innerWidth-this.c.style.width)/2,this.startX=parseInt(this.c.style.marginLeft,10),this.startY=parseInt(this.c.style.marginTop,10)}update(e){if(!this.skip){let t=this.c,i=this.rnd(-this.mag,this.mag),s,h;this.ttl-=e,0===this.ttl?(s=this.startX,h=this.startY):0<this.ttl&&(s=this.startX+i,h=this.startY+i),t.style.marginLeft=s+"px",t.style.marginTop=""+h}}},c=(n.Panel=function(s,h,e){var a=1/0,r=0,A=Math.round,l=A(window.devicePixelRatio||1),o=80*l,t=48*l,n=3*l,c=2*l,d=3*l,g=15*l,m=74*l,p=30*l,u=document.createElement("canvas"),y=(u.width=o,u.height=t,u.style.cssText="width:80px;height:48px",u.getContext("2d"));return y.font="bold "+9*l+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=e,y.fillRect(0,0,o,t),y.fillStyle=h,y.fillText(s,n,c),y.fillRect(d,g,m,p),y.fillStyle=e,y.globalAlpha=.9,y.fillRect(d,g,m,p),{dom:u,update:function(t,i){a=Math.min(a,t),r=Math.max(r,t),y.fillStyle=e,y.globalAlpha=1,y.fillRect(0,0,o,g),y.fillStyle=h,y.fillText(A(t)+" "+s+" ("+A(a)+"-"+A(r)+")",n,c),y.drawImage(u,d+l,g,m-l,p,d,g,m-l,p),y.fillRect(d+m-l,g,l,p),y.fillStyle=e,y.globalAlpha=.9,y.fillRect(d+m-l,g,l,A((1-t/i)*p))}}},n),d={title:"MIKROBEE",start:"Title",w:64,h:64,pal:[[0,0,0],[157,157,157],[255,255,255],[190,38,51],[224,111,139],[73,60,43],[164,100,34],[235,137,49],[247,226,107],[42,72,78],[68,137,26],[163,206,39],[27,38,50],[0,87,132],[49,162,242],[178,220,239]],i:{bee:"R0lGODlhAwACAKEDAC9ITeuJMJ2dnf///yH5BAEKAAMALAAAAAADAAIAAAIEnBYQBQA7",bee1:"R0lGODlhAwAEAKEDAAAAALLc7/fiazGi8iH5BAEKAAMALAAAAAADAAQAAAIHnBYQNgNTAAA7",bg:"R0lGODlhQABAAKECABsmMi9ITvfia/fiayH5BAEKAAIALAAAAABAAEAAAAL+hB2nmHvRHIAS1RldXrR2+WlXqEAbQ6InlrKgqZmhDD90duN0edtRJ7OphKxfo4YZqkg9XtCJXHJ20FfrOb1qW5PRiuEdhT3jV1nk+UZ9K2w11l5L2UwqfdNc4o0oogvcB/iXNPhRt5anl4XoVpQiV2QVtyVJlnY2JXZpabbZCYLpUwk3OTkKtdeY6Jh6iGVoxBdIWChLi7Saa6eIuvi4VXrqJFwS6hej+YmmnOm5jGxFrLQYTUra6pqN7YvnhxvrDRsuKohtzu2L3ktt3Z4lHQnNzJMsb0/v3Ayaj8/u//bO3Tped9QVPHjniLhZsGx9YwiOjkGCFB1NnAUwI5vDav+K8Tum71lIDsYE3fM4D+NGgSsDdrSI6lzMdDPHQSR3a2FOnIYu6lIFNGgwltOGER00st/JByVpJQWplORHky01FsVpFWbFn4zccCX08KbYWmOj7GLl86zas0irur2qEq6FqU6fzk15dynVqCj1QmokF3BbuGuFaqOJcGdZnWEVk63L9fDArX8rA+OYlUtdvlCZ0v2yufNez3hDCz5tGZ5hmYm1Uk7AOLbD2OFsuUZbs3VhOZaHvhwcTyTn0cS75CsAADs=",bg2:"R0lGODlhQABAAMIFABMbJBUeKBgiLRsmMhwpNDGi8jGi8jGi8iH5BAEKAAcALAAAAABAAEAAAAP+CLoQ/CrISau9OMO2lRBDKI5kaQ7ZtTnL535nLJ/p+t7wrOsaA4Y41244rPhIQaKSN2mZbsuorCKtWifWbBSr7e643nBMIi6byOZ0CD0iDNzqayCuhM/Y9JnbPp7nxXh/WoGCcoVdYIdViYpbhI1Kj5BFfpOOllKSmJtAL0+em0kjomd5QTkDpz8llWmqMK+rIppdsamvrK1mtrYktG1RvLi+uid7waciqmfFuzhIzzSCUNSg0o2kPNjJX81qvXfersPhh+AifCi/Yuc06+zc4eLf0Uzz9EKU95wjjPx9+/6pC/jPH6R07gghjHNM3jtOVAQCfLgposRcFC4yy6gxkRhHKVBKhFySAdnITif1pdixDGU9lSkwKMPVzmHMFLFYdGggc+DNnxJ2RhDKEyiFBAA7",bg_1:"R0lGODlhQAAVAIABABsmMv///yH5BAEKAAEALAAAAABAABUAAAKRjI+pywt9HpxAzhtqexzv6GVJZSlkyFglNWqpy36iaZRr55CreY8zjzjVMDuerVfMHCUwSDK49BWF0N9QGUkym83aCQZWcbfZlBfX1VHD0OU46D3P0uqs2C7WVctqDRm/5iJUd/YVJ9fH0VdY9+Wol/jIGElZ+ahoCemXydnp+QkaKjpKWmp6ipqqusra6mpaAAA7",bg_hills:"R0lGODlhQABAAIABABsmMv///yH5BAEKAAEALAAAAABAAEAAAAKNjI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jec6BPT9fvAJJz9NkSccIo8WpSMJXQIw0Qb0+kxertgAV2sFV77kcthJKauxbHFXsY7Lh2bE/I7/BvP8/tQPGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKjpKWmp6ipoahVoAADs=",bg_roof:"R0lGODlhQAAIAKEAAEk8K6RkIkk8K0k8KyH5BAEKAAIALAAAAABAAAgAAAIwhI+py+2/AjxS1YlpBne77oXiGJTmiYKi6gnuC8dCSptjhMj6zrt1vekJh0TfL1UAADs=",bg_sky:"R0lGODlhQAAUAIAAAP///////yH5BAEKAAEALAAAAABAABQAAAI1hI+py+0Po5y02ouz3hyHD4biSJbmiabqypbdC8fyTNdxi+f6zuP2D3z1hsSi8YhMKpfMYQEAOw==",bg_thorns:"R0lGODlhQAAKAIABAC9ITr4mMyH5BAEKAAEALAAAAABAAAoAAAJVjI+py+1vQJKw2htpxHxq+wFfMHaKVj7jCqUOJR6xSyKxLef65G11BgzdRMQNKoO6kYq+IO6XHBJhSqo1+pz+fDDkbPoNL8Pk4RgMXJ7B7Lb7DY+3CwA7",bg_tree_tops:"R0lGODlhQABAAIABABsmMr4mMyH5BAEKAAEALAAAAABAAEAAAAJyhI+py+0Po5y02ouz3rz7D4biCAZOgG6mkk4tgsayvMTsa9CRns/+DwwCe7dZT4hMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4yFQAADs=",bg_trees:"R0lGODlhQABAAIABABsmMr4mMyH5BAEKAAEALAAAAABAAEAAAAL+hI+py+0Po5y02ouz3rz7D4biSDZByQXqCazusjLsMVe1y+Ivrd86b1A9hC1csOf78YxHZK3ZgzKlseWu6FQ4c0iE0vvNwsRiKtFsjSbKZezUXYV/08x2lz7bPuU7uxptdoVX5TdnuKVFdhcINqWXeFf49ve4pvhH13hVqakkKUiJaBmKucg3GIfKVcrqKNpZZyob9joa2zo5x3emGpiU69rmu/q2a3vG2bv7C0orvEwMLB2XPOwLy0tqar2MzYxcy/2Zqo0pPnsYvA096I2tuif6nL4Zzt7djpc/Fok+DT7vEr1m6szdG5fN2Tp5/giSs8cQl0NqEAX+S1hQ10Fvg3LeDdujDx8jWPAgqUH4LU/FfhIfZiy2sSXGegFZDnRJc6HFiTgp1jzZsCdAnTYvpix57NbNmT6JApV59KNJT0GZDjUYcWlUaPF2CrWq8idVqB65TlVqtGy1mFrVrnzaNqTZpH2qbl2bNa1cFwUAADs=",bullet:"R0lGODlhAgABAKECAL4mM+uJMP///////yH5BAEKAAIALAAAAAACAAEAAAICDAoAOw==",cave_bg_teeth:"R0lGODlhQABAAIABAP///0k8KyH5BAEKAAEALAAAAABAAEAAAAL+hI+py+0Po5y02tsC0yrw8yVhRoqLNwKemKIde44uK8+Gfa+Ijee6H0L9VLiecDc7gpTEovDzBAaVTw2zyqkuo02XtqvDcrFgr5iM1p7N6vT6bW3D5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKopX5lcalXfKJyVXx2qqmnX32rf1tVZq+6fr5Eobi/vLuyKGNDY7TINKlgzMzKtM9QVNexbdwlXWke02zbp9la1rfFQMnqL9fX59GjNEDiVuu/7qjg427m5PTd8PlIGOCb59BOdtCPiuy8GEW5QBPOiPHMAaDEFAPDHRQY8hJho3lLj4EQYGjw9HmsQY8qRKFStbQrjnMqbMmTRrKigAADs=",cherry:"R0lGODlhCAAIAKEDAL4mM0SJGuBvizGi8iH5BAEKAAMALAAAAAAIAAgAAAISnBd5yBcGgBtARCqjtrnf9R0FADs=",circle:"R0lGODlhCAAIAIABAP///zGi8iH5BAEKAAEALAAAAAAIAAgAAAIMTIBgl8gNo5wvrWYKADs=",cloud1:"R0lGODlhDwALAMIEAOz9//f7/v3//v7//////////////////yH5BAEKAAcALAAAAAAPAAsAAAMYeErcAyqeRokIclaaN19eKI5kaZ6VRh4JADs=",cloud2:"R0lGODlhCAAHAKECAPT///f//////////yH5BAEKAAMALAAAAAAIAAcAAAIPnIFmIQ3a4mAx0ipuNXgUADs=",creep:"R0lGODlhCAAEAKEDAL4mM6POJ/////fiayH5BAEKAAMALAAAAAAIAAQAAAIMXDKZAWyHxGltxVAAADs=",dot:"R0lGODlhAQABAIABAP///zGi8iH5BAEKAAEALAAAAAABAAEAAAICRAEAOw==",eye:"R0lGODlhBAAEAKECAJ2dnf////fia/fiayH5BAEKAAIALAAAAAAEAAQAAAIGVGKnAdYFADs=",fly:"R0lGODlhCQACAMICAEk8Ky9ITb4mM0SJGr4mM74mM74mM74mMyH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAAQALAAAAAAJAAIAAAMKKBEyIwAs4kgkCQA7",font:"R0lGODlhmwAFAIABAAAAADGi8iH5BAEKAAEALAAAAACbAAUAAAJ4hGOAd6sZFpowPhrxhZz5x2ji5pRTyVEfulaWRV6vfNayksV5O/b53NMBcbjX0JY50pYwkFHDAxGTTlsUpZIadRViYzo1tVazcfHHRSOVWx9UyKK2wym6+nRei47AtkTbAbgTc1X3VvOXtfXFhkfmpVUWqeiSZFkAADs=",ground_grass1:"R0lGODlhQAAHAMIHAAAAAEk8K0WJGlCBKEaDNffia+Bvi////yH5BAEKAAcALAAAAABAAAcAAAM+eHq2/jDCIqt14mqZt1/d12jhR10lRBBPCglwDG9uJsftrc9RHPy/G2cnAAKJsIHRiCwunwPkc0qtWq9YagIAOw==",heart:"R0lGODlhBQAFAIABAL4mMzGi8iH5BAEKAAEALAAAAAAFAAUAAAIIDGygu3mBQgEAOw==",help:"R0lGODlhCAAIAIABAOBvizGi8iH5BAEKAAEALAAAAAAIAAgAAAIPTIBgl8jLnGwqpmidaaYAADs=",hex:"R0lGODlhCwAKAKECABsmMi9ITv///////yH5BAEKAAIALAAAAAALAAoAAAIalINoi+B6gpuqTWov1jdxUEldwIgguQgJJBQAOw==",melon:"R0lGODlhBgAGAMIEAAAAAL4mM0SJGv///zGi8jGi8jGi8jGi8iH5BAEKAAQALAAAAAAGAAYAAAMOGLoToKMxIYeg0ZJ7SQIAOw==",pointer:"R0lGODlhBAAFAKECAAAAAP////fia/fiayH5BAEKAAIALAAAAAAEAAUAAAIIjGWAEKIsIigAOw==",progress:"R0lGODdhQAABAIABAP///74mMywAAAAAQAABAAACB4SPqcvtXQAAOw==",shroom:"R0lGODlhCAAKAKEAAL4mM+Bvi////74mMyH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAAMALAAAAAAIAAoAAAIVHDIToOAPl5PzJZEGvnnrDnLiN2IFADs=",skull:"R0lGODlhBAAEAIABAOBvizGi8iH5BAEKAAEALAAAAAAEAAQAAAIFhB2Ql1kAOw==",spike:"R0lGODlhAwAQAIABAKRkIkk8KyH5BAEKAAEALAAAAAADABAAAAIMDGJ4yesKmzqg2loAADs=",spike2:"R0lGODlhAwAIAIABAKRkIkk8KyH5BAEKAAEALAAAAAADAAgAAAIIDGJ4aQcPXwEAOw==",splat0:"R0lGODlhBgAGAIABAAAAAPfiayH5BAEKAAEALAAAAAAGAAYAAAIKRI4WuqD+HjquAAA7",splat1:"R0lGODlhBgAGAIABAAAAAPfiayH5BAEKAAEALAAAAAAGAAYAAAIKRI4Ba63KkDmTFgA7",splat2:"R0lGODlhBgAGAIABAAAAAPfiayH5BAEKAAEALAAAAAAGAAYAAAIKjA0Be8vqWlJHFQA7",star:"R0lGODlhBgADAKECAOuJMffia74mM74mMyH5BAEKAAIALAAAAAAGAAMAAAIHFGwQF4IHCgA7",star2:"R0lGODlhBAAEAIABAPfiazGi8iH5BAEKAAEALAAAAAAEAAQAAAIGDGKgaQgFADs=",stars:"R0lGODlhQAArAIABAP////fiayH5BAEKAAEALAAAAABAACsAAAJVjI+py+0Po5y02ouz3rz7D1ZASIrlGYxoCKiYuxpt/LUwndn4Zt+7qPtdekJLb1aUHJEnHzCYjEqn1Kq147yustqu9wsOi8fkctOMTnu5al6bwX5XCwA7",target:"R0lGODlhAwADAIABAP////fiayH5BAEKAAEALAAAAAADAAMAAAIDDIxXADs=",title:"R0lGODlhQABAAIABAAAAAL4mMyH5BAEKAAEALAAAAABAAEAAAAJxhI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8dIcNC2E+Surht0cwPkbL3R7SgUEpFJprHW/EmjvOrv6WtqtdPrleTlJpXLJVmGTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4WAAAOw==",worm:"R0lGODlhDAAEAKECAL4mM6POJzGi8jGi8iH5BAEKAAIALAAAAAAMAAQAAAINlAKme2HIgmsTyXelLAA7"},scale:["circle","dot"],audio:["music.ogg","intro.ogg"],sfx:{BOOM:[3,,.3532,.6421,.4668,.054,,.2682,,,,,,,,.5503,.0564,-.2946,1,,,,,.5],JUMP:[0,,.2432,,.1709,.3046,,.1919,,,,,,.5923,,,,,1,,,,,.5],POWERUP:[0,,.0129,.5211,.4714,.4234,,,,,,.4355,.5108,,,,,,1,,,,,.5],SHOOT:[2,,.1128,,.178,.7748,.0046,-.4528,,,,,,.185,.0994,,,,1,,,,,.5],TIP:[3,,.026,,.1909,.605,,-.4942,,,,,,,,,,,1,,,.1405,,.5],TAP:[1,,.1953,,.1186,.2659,,,,,,,,,,,,,1,,,.1,,.5],ALARM:[1,.0241,.9846,.6067,.3041,.1838,,.0565,.1439,-.3068,.1402,.0867,.7339,.1332,-.3119,-.3257,.2875,-.0014,.5866,.0086,-.9675,.3643,,.5]},instruments:{VOX:{wave:"square",pan:-.1,gain:.1},BSS:{wave:"triangle",pan:.5,gain:.7}},tracks:{win:{bpm:180,isLooping:!1,parts:["VOXA41A#41A41A#41G44C54","BSSA41A#41A41A#41G44C54"]},dead:{bpm:120,isLooping:!1,parts:["VOXF31E31D31B31A#24","BSSF31E31D31B31A#24"]},help:{bpm:180,isLooping:!1,parts:["VOXC22C22G12G12A#12A#12B12B12G12E12G14","BSSC22C22G12G12A#12A#12B12B12G12E12G14"]}}},g={levels:[{title:"The Meadows",muzak:"undefined",dist:1e3,floor:0,roof:0,ents:["Fly","Shroom"],freq:80,max:8,bgSpeed:1,bgCol:15,bg:[{k:"Bg",i:"bg_sky",vx:0,y:0,o:.1},{k:"Bg",i:"bg_hills",vx:-.02,y:0,o:.1},{k:"Bg",i:"bg_1",vx:-.2,y:41,o:.2},{k:"Bg",i:"ground_grass1",vx:-.5,y:57},{k:"Cloud",i:"cloud1"},{k:"Cloud",i:"cloud1"},{k:"Cloud",i:"cloud2"}],spawns:[{k:"Shroom",delay:500}]},{title:"The Forest",muzak:"undefined",dist:2500,ents:["Eye","Creep"],freq:60,max:8,floor:0,roof:0,bgSpeed:2,bgCol:0,bg:[{k:"Bg",i:"bg_thorns",vx:-.5,y:54},{k:"Bg",i:"bg_trees",vx:-.2,y:0},{k:"Cloud",i:"cloud1"},{k:"Cloud",i:"cloud1"},{k:"Bg",i:"stars",vx:-0,y:0,o:.1}],spawns:[]},{title:"The Cave",muzak:"undefined",dist:3e3,ents:["Fly","Spike"],freq:40,max:8,floor:62,roof:2,bgSpeed:1,bgCol:0,bg:[{k:"Cave_bg"},{k:"Bg",i:"cave_bg_teeth",vx:-.25,y:0,o:.1}],spawns:[{k:"Spike",delay:200,bottom:!1},{k:"Spike",delay:250,bottom:!0}]}]},m=class{constructor(t){var i=t.g;this.g=t.g,this.col=0,this.active=!1,this.x=-this.g.w,this.w=i.data.w,this.h=i.data.h,this.cb=!1,console.log(this)}update(t){this.active&&(this.x+=this.dir,0<=this.x?(this.dir*=-1,this.cb&&this.cb()):this.x<=-this.g.w&&(this.dir=0,this.active=!1,this.cb=!1))}start(t=!1){this.active=!0,this.dir=1,this.cb=t}render(){this.active&&this.g.draw.rect(this.x,0,this.w,this.h,this.col)}},p=class{constructor(t,i){for(var s in this.g=t,this.o=i,this.id="id-"+Math.random().toString(36).substr(2,16),this.dead=!1,this.remove=!1,this.offsetY=0,this.name=i.i,i)this[s]=i[s];this.lastPos={x:this.x,y:this.y},this.flip={x:0,y:0},this.scale=i.scale||1,this.frame=i.frame||1,this.frames=i.frames||1,this.frameRate=i.frameRate||80,this.frameNext=i.frameNext||0,this.hurtTime=0,i.i&&this.mkImg(i.i),this.hurt=!1,this.anims={idle:{frames:[1],rate:80}},this.changeAnim("idle")}update(t){this.collidesWith&&this.collidesWith.forEach(t=>{this.hitGroup(t)}),0<this.hurtTime?(this.hurt=!0,this.hurtTime--):this.hurt=!1,this.updateAnim(t)}render(){let t=this.g,i=this.hurt?this.iHurt:this.i,s=this.frame;i?(this.flip.y&&(i=t.draw.flip(i,0,1)),this.flip.x&&(i=t.draw.flip(i,1,0),s=this.frames-this.frame+1),t.draw.ctx.drawImage(i,s*this.w-this.w,0,this.w,this.h,~~this.x,~~this.y+this.offsetY,this.w,this.h)):t.draw.rect(this.x,this.y,this.w,this.h,this.col)}updateAnim(t){this.frameNext<0&&(this.frameNext=this.anim.rate,this.anim.counter+=1,this.anim.counter>=this.anim.frames.length&&(this.anim.next?this.changeAnim(this.anim.next):this.anim.counter=0),this.frame=this.anim.frames[this.anim.counter]),this.frameNext-=t}hitGroup(i){this.g.ents.forEach(t=>{t&&t.group===i&&t.id!==this.id&&this.hit(t)&&(this.receiveDamage(t),t.doDamage(this))})}hit(t){return!(t.y+t.h<this.y||t.y>this.y+this.h||t.x+t.w<this.x||t.x>this.x+this.w)}receiveDamage(t){}doDamage(t){}isOffScreen(){var t=this.g;return this.x<-this.w||this.x>t.w+this.w||this.y<-this.h||this.y>t.h+this.h}kill(){this.dead=this.remove=!0}getAngle(t,i){t-=this.x,i-=this.y;return Math.atan2(i,t)}offScreen(){return this.x<0||this.x>W-this.w||this.y<0||this.y>H-this.h}mkImg(t){var i;this.i&&(i=this.g,this.i=i.draw.resize(i.imgs[t],this.scale),this.w=this.i.width/this.frames,this.h=this.i.height,t=this.name+"_hurt",this.g.imgs[t]?this.iHurt=i.imgs[t]:(this.iHurt=i.draw.color(this.i,i.data.pal[3]),this.g.imgs[t]=this.iHurt))}changeAnim(t){this.anim&&this.anim.name&&this.anim.name===t||(this.anim=this.anims[t],this.anim.name=t,this.anim.counter=0,this.frame=this.anim.frames[0],this.frameNext=this.anim.rate)}};d.states={Title:class{constructor(t){this.g=t,this.start=t.H.mkFont(t,1,2),t.initAudio()}init(){this.hi=this.g.H.getHi(),this.fader=0,this.canStart=!1,this.g.spawn("Control",{x:54,y:1,textCol:1,clickCol:3,col:0,w:10,h:10,text:"?",key:"H",cb:()=>{this.g.changeState("Help")}}),this.g.spawn("Control",{y:this.g.h-12,x:!1,w:28,clickCol:3,col:0,key:" ",text:"PLAY",cb:()=>{this.g.mainMusic&&(this.g.mainMusic.pause(),this.g.mainMusic.currentTime=0),this.g.H.toggleFullScreen(this.g.canvas.c),this.g.changeState("Play")}}),this.g.addEvent({t:100,cb:()=>{this.g.mainMusic=AUDIO[1],this.g.mainMusic.currentTime=0,this.g.mainMusic.loop=!1,this.g.mainMusic.play(),this.canStart=!0}})}update(t){var i,s=this.g.input.keys;for(i of this.g.ents)i.update(t);this.canStart&&(s.x||s.Space||s.Enter)&&this.g.changeState("Play")}render(){var t,i=this.g;i.draw.clear(0),this.g.draw.rect(0,16,64,4,8),this.g.draw.rect(0,20,64,4,7),this.g.draw.img(i.imgs.title,0,0);for(t of this.g.ents)t.render();i.draw.img(i.imgs.pointer,i.input.m.x,i.input.m.y)}},Help:class{constructor(t){this.g=t,this.mainText=t.H.mkFont(t,1,2),this.mainTextShadow=t.H.mkFont(t,1,0),this.secondText=t.H.mkFont(t,1,1),window.T=this}init(){var t=this.g;t.H.rnd(1,15),t.H.rnd(1,15);this.g.spawn("Control",{y:18,x:!1,w:60,clickCol:14,col:9,key:"E",text:"BY EOINMCG",cb:()=>{window.location.href="https://eoinmcgrath.com"}}),this.g.spawn("Control",{y:40,x:!1,w:64,clickCol:3,col:9,key:"A",text:"SQUARESAWNOISE",cb:()=>{window.location.href="https://freemusicarchive.org/music/sawsquarenoise/Towel_Defence_OST"}}),this.g.spawn("Control",{y:54,x:!1,w:28,clickCol:11,col:10,key:" ",text:"BACK",cb:()=>{this.g.changeState("Title")}})}update(t){var i;this.g.input.keys;for(i of this.g.ents)i.update(t)}render(){var t,i=this.g;i.draw.clear(12),i.draw.text("CREDITS",this.mainTextShadow,!1,2),i.draw.text("CREDITS",this.mainText,!1,1),i.draw.text("AUDIO BY",this.secondText,!1,34);for(t of this.g.ents)t.render();i.draw.img(i.imgs.target,i.input.m.x-1,i.input.m.y-1)}},Play:class{constructor(t){this.g=t,window.T=this}init(){var t=this.g;window.G=t,this.livesText=t.H.mkFont(t,1,3),this.scoreText=t.H.mkFont(t,1,2),this.scoreTextShadow=t.H.mkFont(t,1,0),this.score=0,this.levelNum=0,this.levelData=g.levels[this.levelNum],this.loadLevel(this.levelData),this.gameOver=!1,this.levelComplete=!1,this.showPointer=!1,this.p1=t.spawn("Bee",{p:this}),this.wiper=new m({p:this,g:t})}update(t){var i,s=this.g;this.baddies=0,this.wiper.update(t);for(i of this.g.ents)"baddies"===i.group&&(this.baddies+=1),i.update(t);!this.levelComplete&&this.dist%this.levelData.freq==0&&this.baddies<this.levelData.max&&(0===this.levelNum?this.waveFly():s.spawn(s.H.rndArray(this.levelData.ents),{p:this})),this.gameOver||--this.dist,this.percent=~~this.dist/this.levelDist*s.w,0!==this.dist||this.levelComplete||(this.bgSpeed=0,this.g.mainMusic&&this.g.mainMusic.pause(),this.initLevelComplete()),this.p1.lives<1&&!this.gameOver&&this.initGameOver()}render(){var t,i=this.g;i.draw.clear(this.levelData.bgCol);for(t of this.g.ents)t.render();i.draw.text(i.H.pad(this.score),this.scoreText,2,2);for(let t=0;t<this.p1.lives;t+=1)i.draw.img(i.imgs.heart,58-6*t,2);var s=0<this.percent?i.w-this.percent-i.w:0;i.draw.img(i.imgs.progress,s,0,1,.25),this.gameOver&&0<this.g.fader&&i.draw.text("GAMEOVER",this.scoreText,!1,20),this.showPointer&&i.draw.img(i.imgs.pointer,i.input.m.x,i.input.m.y),this.wiper.render()}killBaddie(t){.5<Math.random()&&this.g.spawn("Powerup",{p:this,x:t.x,y:t.y}),this.score+=t.val,t.remove=!0}loadLevel(t){t&&(this.bgSpeed=t.bgSpeed,this.levelDist=t.dist,this.dist=t.dist,this.waves=[],this.g.ents.forEach(t=>{"bee"!==t.name&&(t.remove=!0)}),t.bg.forEach(t=>{var i=t.k;t.p=this,console.log(i,t),this.g.spawn(i,t)}),t.spawns.forEach(t=>{let i=t.k,s=t.delay;(t.p=this).g.addEvent({t:s,cb:()=>{this.g.spawn(i,t)}})}),this.g.ents.reverse(),"undefined"!==t.muzak&&(this.g.mainMusic=AUDIO[t.muzak],this.g.mainMusic.currentTime=0,this.g.mainMusic.loop=!0,this.g.mainMusic.play()),this.levelComplete=!1,this.p1)&&(this.p1.x=20)}waveFly(i=!1,s=3,h=!1){if(!(this.percent<0||this.gameOver)){const e=this.g;i=i||e.H.rndArray(["blue","green","brown"]),h=h||e.H.rnd(4,60),s=s||5;for(let t=0;t<s;t+=1)e.addEvent({t:20*t,cb:()=>{this.gameOver||e.spawn("Fly",{p:this,type:i,y:h})}})}}initGameOver(){this.gameOver||(this.gameOver=!0,this.g.mainMusic&&this.g.mainMusic.pause(),this.p1.remove=!0,this.bgSpeed=0,this.g.spawn("Overlay",{p:this,col:3}),this.g.addEvent({t:300,cb:()=>{this.showPointer=!0,this.g.spawn("Control",{y:this.g.h-12,x:!1,w:28,clickCol:3,col:0,key:" ",text:"REPLAY",cb:()=>{this.g.mainMusic&&(this.g.mainMusic.pause(),this.g.mainMusic.currentTime=0),this.g.changeState("Play")}})}}))}initLevelComplete(){this.levelComplete||(this.levelComplete=!0,this.g.events=[],this.wiper.start(()=>{console.log("DONE",this.wiper),this.levelNum+=1,this.levelData=g.levels[this.levelNum],this.levelData||this.g.changeState("Win"),this.loadLevel(this.levelData)}))}},Win:class{constructor(t){this.g=t,this.font=t.H.mkFont(t,1,3)}init(){this.fader=0,this.canStart=!1,this.g.addEvent({t:100,cb:()=>{this.canStart=!0,console.log("CAN START")}})}update(){var t=this.g.input.keys;this.canStart&&(t.x||t.Space||t.Enter)&&this.g.changeState("Title")}render(){var t=this.g,i=this.g.draw;i.clear(15),i.ctx.globalAlpha=.1,i.img(this.g.imgs.bg_sky,0,0),i.ctx.globalAlpha=.1,i.img(this.g.imgs.bg_hills,0,0),i.ctx.globalAlpha=1,i.img(this.g.imgs.ground_grass1,0,57),i.text("YOU WIN",this.font,!1,10),i.img(this.g.imgs.heart,25,20,3,1),i.img(t.imgs.target,t.input.m.x,t.input.m.y)}}},d.ents={Sprite:p,Text:class{constructor(t,i){for(var s in i.group="text",i.vy=i.vy||-2.5,i.vx=i.vx||0,i.w=10,i.w=10,i.alpha=1,i.scale=1,i.col=i.col||4,i.accel=i.accel||.25,i.fade=i.fade||.001,i)this[s]=i[s];this.g=t,this.p=t.imgs[`font_${i.scale}_`+i.col]}update(t){(this.y<0||this.alpha<.1)&&(this.remove=!0),this.vy-=this.accel,this.alpha-=this.fade,this.vx&&(this.x+=this.vx*t),this.y+=this.vy*t}render(){var t=this.g.draw;this.text?t.text(this.text,this.p,this.x,this.y):this.o&&t.ctx.drawImage(this.i,this.x,this.y)}},Spawn:class extends p{constructor(t,i){i.group="baddies",i.i="dot_1_2",i.col=11,super(t,i),this.points=this.setPoints(),(window.S=this).w=this.h=4,this.cycles=0,this.maxCycles=3,this.alpha=0}update(t){this.points.forEach(t=>{this.g.draw.rect(t.x,t.y,1,1,11)});let s=!1;this.points.forEach((t,i)=>{~~t.x===t.tx&&~~t.y===t.ty?s=!0:(t.x+=t.vx,t.y+=t.vy)}),s&&(this.cycles+=1,this.points=this.setPoints()),this.alpha+=t/2,1<this.alpha&&(this.g.spawn(this.t,{p:this.p,x:this.x,y:this.y}),this.remove=!0)}render(t){this.g.draw.ctx.globalAlpha=this.alpha,this.g.draw.rect(this.x,this.y,4,4,11),this.g.draw.ctx.globalAlpha=1,this.points.forEach(t=>{var i=~~t.x===t.tx&&~~t.y===t.ty?2:11;this.g.draw.rect(t.x,t.y,4,1,i)})}setPoints(){var t=[];return t.push({x:this.x,y:this.y-20,vx:0,vy:.75,tx:this.x,ty:this.y}),t.push({x:this.x,y:this.y+20,vx:0,vy:-.75,tx:this.x+2,ty:this.y}),t.push({x:this.x-20,y:this.y,vx:.75,vy:0,tx:this.x,ty:this.y}),t.push({x:this.x+20,y:this.y,vx:-.75,vy:0,tx:this.x,ty:this.y}),t}},Boom:class{constructor(t,i){i.col=i.col||2,this.g=t;var s="circle_"+i.col;this.g.imgs[s]?this.i=this.g.imgs[s]:(this.i=t.draw.color(t.imgs.circle,t.data.pal[i.col]),this.g.imgs[s]=this.i),this.startX=i.x,this.startY=i.y,this.magnitude=i.m||4,this.scale=1,this.factor=i.factor||.5}update(){this.scale+=this.factor,this.scale>this.magnitude&&0<this.factor&&(this.factor*=-1),this.scale<=1&&(this.remove=!0)}render(){var t=this.i.width*this.scale/2,i=this.startX-t,t=this.startY-t;this.g.draw.img(this.i,i,t,this.scale)}},Particle:class{constructor(t,i){this.g=t,this.x=i.x,this.y=i.y,this.w=i.w||1,this.h=this.w,this.vx=t.H.rnd(-100,100),this.vy=-1*t.H.rnd(50,150),this.col=i.col||6,this.r=i.r||1,this.i=t.imgs[`dot_${this.w}_`+this.col]}update(t){this.x+=this.vx*t,this.y+=this.vy*t,this.y>this.g.h&&(this.remove=!0)}render(t){this.g.draw.ctx.drawImage(this.i,this.x,this.y)}},Control:class extends p{constructor(t,i){i.scale=2,"col"in i||(i.col=7),"clickCol"in i||(i.clickCol=3),i.i||(i.size=i.size||1,i.w=i.w||36,i.h=i.h||10),i.textCol=i.textCol||2,i.hoverCol=i.hoverCol||2,i.center=!1===i.x,t.imgs["font_"+i.textCol]||(t.imgs["font_"+i.textCol]=t.H.mkFont(t,1,i.textCol)),t.imgs["font_"+i.hoverCol]||(t.imgs["font_"+i.hoverCol]=t.H.mkFont(t,1,i.hoverCol)),super(t,i),this.flip.x=!!i.flip,this.g=t,i.i||(this.x=i.x||t.w/2-i.w/2,this.p=t.imgs["font_"+i.textCol],this.pHover=t.imgs["font_"+i.hoverCol],this.clicked=!1,this.clickCol=i.clickCol,this.currentCol=i.col,this.clicked=!1,this.textW=t.draw.textWidth(this.text,this.p)/2,this.tX=i.x?i.x+20:t.w/2-this.textW),this.origX=this.x,this.origY=i.y,this.center||(this.tX=this.x+4,console.log("CENTER"))}update(){var t=this.checkTouch()||this.checkClick()||this.checkKey();this.hover=this.intersects(this.g.input.m),this.currentCol=this.hover?this.clickCol:this.col,t&&this.cb?(this.g.audio.play("TAP"),this.cb.call(this)):t?(this.hurt=!0,this.x=this.origX+3,this.y=this.origY+3):(this.hurt=!1,this.x=this.origX,this.y=this.origY)}render(){var t;this.i?super.render():(t=this.hover?this.pHover:this.p,this.g.draw.rect(this.x,this.y,this.w,this.h,this.currentCol),this.g.draw.text(this.text,t,this.tX,this.y+2))}intersects(t){return t.x>this.x&&t.x<this.x+this.w&&t.y>this.y&&t.y<this.y+this.h}checkKey(){if(this.key&&!0===this.g.input.keys[this.key])return!(this.g.input.keys[this.key]=!1)}checkClick(){var t=this.g.input.m;return t.click&&this.hit(t)}checkTouch(){let t=this.g.input.m.touches,i=t.length;for(;i--;)if(t[i].x>=this.x&&t[i].x<=this.x+this.w)return!0;return!1}},Bullet:class extends p{constructor(t,i){i.group="bullet",i.i="bullet",i.scale=1,super(t,i),this.g=t,this.o=i,this.speed=1.75,this.a=i.a||0,this.col=7,this.vx=this.speed*Math.cos(this.a),this.vy=this.speed*Math.sin(this.a)}update(t){this.lastX=this.x,this.lastY=this.y,this.x+=this.vx*this.speed,this.y+=this.vy*this.speed,this.isOffScreen()&&(this.remove=!0)}render(){super.render();var t=this.g.draw;t.ctx.globalAlpha=.5,t.rect(this.lastX,this.lastY,1,1,8),t.ctx.globalAlpha=1}doDamage(t){}hitBaddie(t){var i=this.g;i.boom(this.x,this.y,t.col,3),i.audio.play("TIP"),this.remove=!0}},Bee:class extends p{constructor(t,i){i.group="player",i.i=i.i||"bee",i.i1="bee1",i.scale=1,i.frames=1,super(t,i),this.score=0,this.anims={move:{frames:[1,1],rate:.05}},this.changeAnim("move"),this.x=16,this.y=32,this.lastY=0,this.g=t,this.o=i,this.started=!1,this.powerups=0,this.gravity=9.8,this.vx=0,this.vy=0,this.maxVy=1.5,this.floor=58,this.val=10,this.angle=0,this.collidesWith=["baddies"],this.delay=5,this.gunFlash=0,this.lives=2,window.B=this}update(t){if(super.update(t),this.p.levelComplete)return this.buzzOff();var t=this.g,i=t.input.keys,i=t.input.m.click||i.Space||i.Enter||t.input.touching;this.started=!!i||this.started,this.started&&(this.y>this.floor&&(this.y=this.floor),i&&0<this.y?this.y-=.75:this.y+=.75,i&&this.delay<0&&this.shoot(),this.x<0&&(this.x=0),this.x>t.w-this.w&&(this.x=t.w-this.w),this.y<0&&(this.y=0),this.y>t.h-this.h&&(this.y=t.h-this.h),this.delay--,this.gunFlash--,this.lastY=this.y)}render(){var t=this.g.draw,i=(0<this.gunFlash&&t.img(this.g.imgs.circle_1_2,this.x+this.w/2,this.y,.5,1),this.hurt?this.iHurt:this.i);t.img(i,this.x,this.y)}hitBaddie(t){if(!(this.p.levelComplete||0<this.hurtTime)){this.hurtTime=100,--this.lives,this.g.boom(this.x,this.y,2,4);let t=4;for(;t--;)this.g.addEvent({t:15*t,cb:()=>{var t=this.g.H.rnd(-2,2),i=this.g.H.rnd(-2,2);this.g.boom(this.x+t,this.y+i,2,4)}})}}shoot(){var t=this.g;this.delay=10,this.p.shots+=1,t.audio.play("SHOOT"),this.gunFlash=3,t.spawn("Bullet",{x:this.x+this.w/2,y:this.y+this.h/2,a:0,p:this.p}),0<this.powerups&&t.spawn("Bullet",{x:this.x+this.w/2,y:this.y-this.h/2,a:0,p:this.p}),1<this.powerups&&t.spawn("Bullet",{x:this.x+this.w/2,y:this.y+this.h/2,a:.7,p:this.p}),2<this.powerups&&t.spawn("Bullet",{x:this.x+this.w/2,y:this.y+this.h/2,a:5.5,p:this.p}),3<this.powerups&&t.spawn("Bullet",{x:this.x+this.w/2,y:this.y+this.h/2,a:3.14,p:this.p})}powerup(){this.powerups+=1}buzzOff(){var t;70<this.x||(t=this.g.w/2,this.x+=1,this.y<=t?this.y+=1:this.y>=t&&--this.y)}},Worm:class extends p{constructor(t,i){i.group="baddies",i.i="worm",i.frames=3,i.scale=1,i.val=20,super(t,i),this.anims={move:{frames:[1,2,3,2],rate:.075}},this.changeAnim("move"),this.val=10,this.vx=.1,this.vy=-.1,this.x||(this.x=t.H.rnd(0,64)),this.y||(this.y=t.H.rnd(0,64)),this.x>this.g.w/2&&(this.vx*=-1,this.flip.x=!this.flip.x),this.collidesWith=["player","bullet"]}update(t){super.update(t),this.x+=this.vx,this.y+=this.vy,(this.x<0||this.x>this.g.w-this.w)&&(this.vx*=-1,this.flip.x=!this.flip.x),(this.y<0||this.y>this.g.h-this.h)&&(this.vy*=-1)}receiveDamage(t){this.p.killBaddie(this),t.hurt||t.hitBaddie(this)}},Eye:class extends p{constructor(t,i){i.group="baddies",i.i="eye",i.frames=1,i.scale=1,i.val=30,super(t,i),this.val=20,this.vx=.1,this.vy=-.1,this.x=64,this.y||(this.y=t.H.rnd(4,60)),this.collidesWith=["player","bullet"],this.moveTo=!1,this.active=!1}update(t){var i,s;super.update(t),this.active?(!(i=(t=this).p.p1).remove&&!t.moveTo&&.99<Math.random()?this.moveTo={x:-5,y:i.y}:t.moveTo&&(i=~~(t.moveTo.x-t.x),s=~~(t.moveTo.y-t.y),t.moveTo.d=~~Math.sqrt(i*i+s*s),2<t.moveTo.d?(t.x+=.05*i,t.y+=.05*s):(t.x=t.moveTo.x,t.y=t.moveTo.y,t.d=0,t.moveTo=!1)),this.x<-4&&(this.remove=!0)):(this.x-=.2,this.x<57&&(this.active=!0))}render(){super.render();let t=this.p.p1,i=this.x+1,s=this.y+1,h=t.x,e=t.y;t.remove&&(h=this.g.input.m.x,e=this.g.input.m.y),h>i&&(i+=1),e>s&&(s+=1),this.g.draw.rect(i,s,1,1,3)}receiveDamage(t){this.p.killBaddie(this),t.hurt||t.hitBaddie(this)}},Creep:class extends p{constructor(t,i){i.group="baddies",i.i="creep",i.frames=2,i.scale=1,i.val=20,super(t,i),this.anims={move:{frames:[1,2],rate:.5}},this.changeAnim("move"),this.val=20,this.x=60,this.y=0,this.collidesWith=["player","bullet"],this.flip.x=!0,this.maxY=t.H.rnd(15,40),this.vy=t.H.rndArray([.25,.5]),console.log(this.x,this.y)}update(t){super.update(t),this.x-=.5,this.y<this.maxY&&(this.y+=this.vy),this.x<-6&&(this.remove=!0)}render(){this.g.draw.ctx.globalAlpha=.5,this.g.draw.rect(this.x+1,0,1,this.y,1),this.g.draw.ctx.globalAlpha=1,super.render()}receiveDamage(t){this.p.killBaddie(this),t.hurt||t.hitBaddie(this)}},Fly:class extends p{constructor(t,i){i.group="baddies",i.i="fly",i.frames=3,i.scale=1,i.val=20,i.col=3,super(t,i),this.o=i,this.anims={blue:{frames:[1],rate:.035},green:{frames:[2],rate:.035},brown:{frames:[3],rate:.035}},this.type=i.type||t.H.rndArray(Object.keys(this.anims)),2===this.p.levelNum&&(this.type="blue"),this.changeAnim(this.type),this.setBehavior(this.type),this.val=10,2===this.p.levelNum&&(this.maxTurns=1),this.x||(this.x=60,this.flip.x=!1),this.y||(this.y=t.H.rnd(4,60)),this.x>this.g.w/2&&(this.vx*=-1,this.flip.x=!this.flip.x),this.collidesWith=["player","bullet"]}setBehavior(t){var i=this.g,s=this.o.x||60,h=this.o.y||i.H.rnd(4,60);switch(t){case"brown":this.x=s,this.y=h,this.vx=-.75,this.vy=32<this.y?.5:-.5,this.turns=0,this.maxTurns=2,this.flip.x=!1;break;case"green":this.x=s,this.y=h,this.vx=-.5,this.vy=32<this.y?.25:-.25,this.turns=0,this.maxTurns=2,this.flip.x=!1;break;default:this.x=s,this.y=h,this.vx=-.6,this.vy=0,this.turns=0,this.maxTurns=2,this.flip.x=!1}}update(t){super.update(t),this.x+=this.vx,this.y+=this.vy;var t=this.x<0||this.x>this.g.w-this.w,i=this.x<-this.w||this.x>this.g.w+this.w,s=this.turns>this.maxTurns;t&&!s&&(this.vx*=-1,this.flip.x=!this.flip.x,this.turns+=1),s&&i&&(this.remove=!0),(this.y<0||this.y>this.g.h-this.h)&&(this.vy*=-1,this.turns+=1)}receiveDamage(t){this.p.killBaddie(this),t.hurt||t.hitBaddie(this)}},Bg:class{constructor(t,i){this.g=t,this.p=i.p,this.vy=i.vy||0,this.vx=i.vx||0,this.x=i.x||0,this.y=i.y||0,this.o=i.o||1,this.i=i.i,this.w=t.imgs[i.i].width,this.h=t.imgs[i.i].height}update(){this.x+=this.vx*this.p.bgSpeed,this.y+=this.vy,this.x<-this.w&&(this.x=0)}render(){var t=Math.ceil(this.x),i=Math.ceil(this.y);this.g.draw.img(this.g.imgs[this.i],t,i,1,this.o),this.g.draw.img(this.g.imgs[this.i],t+this.w,i,1,this.o)}},Cave_bg:class{constructor(t,i){this.g=t,this.g=t,this.p=i.p,this.x=0,this.y=-4,this.v=-1,this.g.imgs.floor=this.g.draw.flip(this.g.imgs.bg_roof,1,1)}update(){this.x+=this.v,this.x<=-64&&(this.x=0,this.y=-4),0===Math.abs(this.x%16)&&--this.y}render(){this.g.draw.img(this.g.imgs.bg_roof,this.x,this.y),this.g.draw.img(this.g.imgs.bg_roof,64+this.x,this.y+4),this.g.draw.img(this.g.imgs.floor,this.x,64+this.y),this.g.draw.img(this.g.imgs.floor,64+this.x,64+this.y+4)}},Cloud:class{constructor(t,i){this.g=t,this.p=i.p,this.i=i.i||"cloud2",this.w=t.imgs[i.i].width,this.h=t.imgs[i.i].height,this.reset()}update(t){this.x-=this.vx*this.p.bgSpeed,this.x<-this.w&&this.reset()}render(){this.g.draw.img(this.g.imgs[this.i],this.x,this.y,this.scale,.5)}reset(){var t=this.g;this.x=t.data.w+this.w,0===this.p.levelNum?this.y=t.H.rndArray(0,15,30):this.y=t.H.rndArray([0,15,30]),this.scale=t.H.rndArray([.5,1,1.5]),this.vx=1.2*this.scale}},Shroom:class extends p{constructor(t,i){i.group="baddies",i.i="shroom",i.frames=2,i.scale=1,super(t,i),this.anims={idle:{frames:[2],rate:1}},this.changeAnim("idle"),this.x=100,this.y=t.data.h-this.h,this.vx=-.25,this.flip.x=!0,this.collidesWith=["player","bullet"]}update(t){super.update(t),this.p.percent<=0||0===this.p.bgSpeed||(this.x+=-.5,this.x<-12&&(this.x=80))}receiveDamage(t){"bee"===t.name?t.hitBaddie(this):(this.g.audio.play("TIP"),this.hurtTime=40,this.g.burst(t.x,t.y,3,1),t.remove=!0)}},Powerup:class extends p{constructor(t,i){i.group="baddies",i.i="star",i.frames=2,i.scale=1,super(t,i),this.x=i.x,this.y=i.y,this.anims={sparkle:{frames:[1,2],rate:.2}},this.changeAnim("sparkle"),this.vx=-.25,this.collidesWith=["player"]}update(t){super.update(t),this.x+=-.5,this.y<this.p.p1.y?this.y+=.2:this.y>this.p.p1.y&&(this.y-=.2),this.x<-12&&(this.remove=!0)}receiveDamage(t){this.g.audio.play("POWERUP"),this.remove=!0,t.powerup()}},Overlay:class{constructor(t,i){this.g=t,this.p=i.p,this.col=i.col||1,this.rate=i.rate||.05,this.maxAlpha=i.maxAlpha||.8,this.alpha=0}update(t){this.alpha<this.maxAlpha&&(this.alpha+=this.rate)}render(){var t=this.g;t.draw.ctx.globalAlpha=this.alpha,t.draw.rect(0,0,t.data.w,t.data.h,this.col),t.draw.ctx.globalAlpha=1}},Wiper:m,Spike:class extends p{constructor(t,i){i.i=t.H.rndArray(["spike","spike2"]),i.group="baddies",i.frames=1,i.scale=1,super(t,i),.5<Math.random()?(this.y=3,this.flip.y=1):this.y=t.h-this.h-1,this.x=t.w,this.vx=this.p.bgSpeed,this.collidesWith=["player","bullet"]}update(t){super.update(t),this.x-=this.vx,this.x<-this.w&&(this.remove=!0),0===Math.abs(this.x%16)&&--this.y}receiveDamage(t){"bee"===t.name?t.hitBaddie(this):(this.g.audio.play("TIP"),this.g.burst(t.x,t.y,5,1),t.remove=!0)}}},new class{constructor(t){var i=navigator.userAgent.toLowerCase();this.mobile="createTouch"in document||!1,this.android=-1<i.indexOf("android"),this.ios=/ipad|iphone|ipod/.test(i),this.firefox=-1<i.indexOf("firefox"),this.data=t,this.w=t.w,this.h=t.h,this.dt=0,this.fps=60,this.frameStep=1/this.fps,this.frameCurr=0,this.framePrev=A.timeStamp(),this.stateName=t.start,this.H=A,this.states=t.states,this.availEnts=t.ents,this.mute=!1,this.score=0,this.hiScore=200,this.plays=0,this.production=window.BUILD||!1,this.ents=[],this.imgs=[],this.fonts=[],this.events=[],this.init(),window.G=this}init(){var t=new i(this.data.i,this.data.audio);document.title=this.data.title,this.canvas=new s(this.data.w,this.data.h),this.canvas.c.style.cursor="none",this.draw=new h(this.canvas.c,this.canvas.ctx,this.data.pal),this.input=new e(this.canvas.c,this),this.shake=new o(this.canvas.c,this.H.rnd,this.ios),this.audio={play(){}},this.music={play(){},stop(){}},t.start().then(t=>{this.imgs=t,this.data.scale.forEach(t=>{this.scaleUp(t)}),document.getElementById("l").style.display="none",this.changeState(this.stateName),this.canvas.c.style.display="block",this.initAudio();t=this.draw.resize(this.imgs.bee,16);this.favIcon(t),this.production&&(this.stats=new c,this.stats.showPanel(0)),this.loop(),window.addEventListener("contextmenu",t=>(t.preventDefault(),!1))})}initAudio(){this.ios||(this.audio=r,this.audio.init(this,this.data.sfx))}scaleUp(i){let s=3;for(;s--;){let t=this.data.pal.length;for(;t--;){var h=this.draw.color(this.imgs[i],this.data.pal[t]);this.imgs[`${i}_${s}_`+t]=this.draw.resize(h,s)}}}favIcon(t){var i=document.createElement("canvas"),s=i.getContext("2d"),h=document.createElement("link");i.width=64,i.height=64,s.drawImage(t,0,0),h.type="image/x-icon",h.rel="shortcut icon",h.href=i.toDataURL("image/x-icon"),document.getElementsByTagName("head")[0].appendChild(h)}changeState(t){this.ents=[],this.events=[],this.state=new this.states[t](this),this.music.stop(),this.state.init()}loop(){for(this.production&&this.stats.begin(),this.frameCurr=A.timeStamp(),this.dt=this.dt+Math.min(1,(this.frameCurr-this.framePrev)/1e3);this.dt>this.frameStep;)this.dt=this.dt-this.frameStep,this.update(this.frameStep);this.render(this.dt),this.framePrev=this.frameCurr,this.input.freshKeys.KeyF&&this.H.toggleFullScreen(this.canvas.c),this.input.freshKeys.KeyM&&(this.mute=!this.mute,this.mute&&this.mainMusic?this.mainMusic.pause():this.mainMusic&&this.mainMusic.play()),this.input.freshKeys=[],this.production&&this.stats.end(),requestAnimationFrame(()=>this.loop())}update(t){this.fader=Math.sin(.005*(new Date).getTime()),this.runEvents(t),this.state.update(t),this.shake.update(t);let i=this.ents.length;for(;i--;)this.ents[i].remove&&this.ents.splice(i,1)}render(t){this.state.render(t)}spawn(t,i){t=new this.availEnts[t](this,i);return this.ents.push(t),t}boom(t,i,s=7,h=4,e=2){this.audio.play("BOOM"),e&&this.shake.start(e/2,.5),this.spawn("Boom",{x:t,y:i,m:e,col:s}),this.burst(t,i,s,h)}burst(t,i,s,h,e=1){for(;h--;)this.ents.push(new this.availEnts.Particle(this,{x:t,y:i,col:s,w:e}))}addEvent(t){this.events.push(t)}runEvents(t){let i=this.events.length;for(;i--;){var s=this.events[i];if(!s)break;s.t-=100*t,s.t<0&&(s.cb.call(this),this.events.splice(i,1))}}}(d)})();</script></body</html>